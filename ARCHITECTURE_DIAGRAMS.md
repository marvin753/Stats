# Architecture Diagrams
## Quiz Stats Animation System

Comprehensive visual representations of the system architecture.

---

## 1. Complete System Overview

```
┌──────────────────────────────────────────────────────────────────────┐
│                         USER INTERACTION                              │
└──────────────────────────────────────────────────────────────────────┘
                                  │
                    ┌─────────────┴─────────────┐
                    │   Keyboard Shortcut       │
                    │   (Trigger Automation)    │
                    └─────────────┬─────────────┘
                                  │
┌─────────────────────────────────▼─────────────────────────────────────┐
│                      SCRAPER SERVICE                                   │
│  ┌──────────────────────────────────────────────────────────────┐    │
│  │  Playwright Browser (Headless Chrome)                         │    │
│  │  - Extracts questions from DOM                                │    │
│  │  - Multiple extraction strategies                             │    │
│  │  - Handles dynamic content                                    │    │
│  └──────────────────────────────────────────────────────────────┘    │
└───────────────────────────────────┬────────────────────────────────────┘
                                    │ JSON: {questions, answers}
                                    │
┌───────────────────────────────────▼────────────────────────────────────┐
│                         NGINX REVERSE PROXY                            │
│  ┌──────────────────────────────────────────────────────────────┐    │
│  │  - SSL/TLS Termination                                        │    │
│  │  - Rate Limiting (5 req/s general, 1 req/s analyze)          │    │
│  │  - Load Balancing (Least Connections)                        │    │
│  │  - CORS Headers                                               │    │
│  │  - Security Headers (CSP, HSTS, X-Frame-Options)            │    │
│  │  - Connection Limits (10 per IP)                             │    │
│  │  - Gzip Compression                                          │    │
│  └──────────────────────────────────────────────────────────────┘    │
└───────────────────────────────────┬────────────────────────────────────┘
                                    │
                    ┌───────────────┴───────────────┐
                    │                               │
┌───────────────────▼─────┐         ┌──────────────▼─────────────────────┐
│   HTTP API Requests     │         │   WebSocket Connections             │
│   /api/analyze          │         │   Real-time Updates                 │
│   /health               │         │   Stats App Communication           │
└───────────────────┬─────┘         └──────────────┬─────────────────────┘
                    │                               │
┌───────────────────▼───────────────────────────────▼─────────────────────┐
│                      BACKEND API CLUSTER                                 │
│  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────┐       │
│  │ Backend 1  │  │ Backend 2  │  │ Backend 3  │  │ Backend N  │       │
│  │ Node.js    │  │ Node.js    │  │ Node.js    │  │ (Auto-scale)       │
│  │ Express    │  │ Express    │  │ Express    │  │            │       │
│  └─────┬──────┘  └─────┬──────┘  └─────┬──────┘  └─────┬──────┘       │
│        │                │                │                │              │
│        └────────────────┴────────────────┴────────────────┘              │
│                                  │                                       │
│  Features:                       │                                       │
│  - Question Validation           │                                       │
│  - Request ID Tracking           │                                       │
│  - Structured Logging            │                                       │
│  - Metrics Collection            │                                       │
│  - Error Handling                │                                       │
└──────────────────────────────────┬───────────────────────────────────────┘
                                   │
                ┌──────────────────┼──────────────────┐
                │                  │                  │
┌───────────────▼────┐  ┌──────────▼──────┐  ┌───────▼──────────────────┐
│   REDIS CACHE      │  │  OPENAI API     │  │  STATS APP (Swift)       │
│                    │  │                 │  │                          │
│  - Session Store   │  │  - GPT-3.5/4    │  │  - Animation Display     │
│  - Response Cache  │  │  - Answer AI    │  │  - WebSocket Client      │
│  - Rate Limit Data │  │  - JSON Output  │  │  - Visual Stats          │
│  - Persistent Vol  │  │  - 30s Timeout  │  │  - macOS Native          │
└───────────────┬────┘  └─────────────────┘  └──────────────────────────┘
                │
                │ [Data Flow: Answer Indices]
                │
┌───────────────▼────────────────────────────────────────────────────────┐
│                     MONITORING & LOGGING STACK                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐                │
│  │  Prometheus  │  │   Grafana    │  │     Loki     │                │
│  │              │  │              │  │              │                │
│  │  - Metrics   │─▶│  - Dashboards│  │  - Logs      │                │
│  │  - Alerts    │  │  - Queries   │  │  - Aggreg.   │                │
│  │  - TSDB      │  │  - Visualize │  │  - Search    │                │
│  └──────────────┘  └──────────────┘  └──────────────┘                │
│                            │                                            │
│  Alert Destinations:       │                                            │
│  ┌──────────────┐  ┌──────▼───────┐                                   │
│  │    Slack     │  │    Email     │                                    │
│  └──────────────┘  └──────────────┘                                    │
└────────────────────────────────────────────────────────────────────────┘
```

---

## 2. Docker Compose Architecture (Development)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         DOCKER HOST MACHINE                              │
│                                                                          │
│  ┌────────────────────────────────────────────────────────────────┐    │
│  │                      quiz-network (Bridge)                      │    │
│  │                      172.20.0.0/16                             │    │
│  │                                                                 │    │
│  │  ┌──────────────────────────────────────────────────────┐     │    │
│  │  │  nginx:80                                             │     │    │
│  │  │  Container: quiz-nginx                                │     │    │
│  │  │  - Reverse Proxy                                      │     │    │
│  │  │  - Rate Limiting                                      │     │    │
│  │  │  Volume: nginx-logs:/var/log/nginx                   │     │    │
│  │  └────────────────────┬──────────────────────────────────┘     │    │
│  │                       │                                         │    │
│  │  ┌────────────────────▼──────────────────────────────────┐     │    │
│  │  │  backend:3000                                          │     │    │
│  │  │  Container: quiz-backend                               │     │    │
│  │  │  - Node.js 20 Alpine                                   │     │    │
│  │  │  - Express API                                         │     │    │
│  │  │  - Health Checks                                       │     │    │
│  │  │  Volume: backend-logs:/app/logs                       │     │    │
│  │  │  Volume: ./backend:/app (dev mode)                    │     │    │
│  │  └────────────────────┬──────────────────────────────────┘     │    │
│  │                       │                                         │    │
│  │  ┌────────────────────▼──────────────────────────────────┐     │    │
│  │  │  redis:6379                                            │     │    │
│  │  │  Container: quiz-redis                                 │     │    │
│  │  │  - Redis 7 Alpine                                      │     │    │
│  │  │  - Persistence Enabled                                 │     │    │
│  │  │  Volume: redis-data:/data                             │     │    │
│  │  └────────────────────────────────────────────────────────┘     │    │
│  │                                                                 │    │
│  │  ┌──────────────────────────────────────────────────────┐     │    │
│  │  │  scraper                                              │     │    │
│  │  │  Container: quiz-scraper                              │     │    │
│  │  │  - Playwright + Chromium                              │     │    │
│  │  │  Volume: scraper-screenshots:/home/scraper/Downloads  │     │    │
│  │  └──────────────────────────────────────────────────────┘     │    │
│  │                                                                 │    │
│  │  ┌──────────────────────────────────────────────────────┐     │    │
│  │  │  prometheus:9090                                      │     │    │
│  │  │  Container: quiz-prometheus                           │     │    │
│  │  │  Volume: prometheus-data:/prometheus                 │     │    │
│  │  └──────────────────────────────────────────────────────┘     │    │
│  │                                                                 │    │
│  │  ┌──────────────────────────────────────────────────────┐     │    │
│  │  │  grafana:3001                                         │     │    │
│  │  │  Container: quiz-grafana                              │     │    │
│  │  │  Volume: grafana-data:/var/lib/grafana               │     │    │
│  │  └──────────────────────────────────────────────────────┘     │    │
│  │                                                                 │    │
│  │  ┌──────────────────────────────────────────────────────┐     │    │
│  │  │  loki:3100                                            │     │    │
│  │  │  Container: quiz-loki                                 │     │    │
│  │  │  Volume: loki-data:/loki                              │     │    │
│  │  └──────────────────────────────────────────────────────┘     │    │
│  │                                                                 │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
│  Exposed Ports:                                                          │
│  - 80:80    (Nginx HTTP)                                                │
│  - 3000:3000 (Backend API)                                              │
│  - 6379:6379 (Redis)                                                    │
│  - 9090:9090 (Prometheus)                                               │
│  - 3001:3000 (Grafana)                                                  │
│  - 3100:3100 (Loki)                                                     │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

---

## 3. Kubernetes Architecture (Production)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        KUBERNETES CLUSTER                                │
│                                                                          │
│  ┌────────────────────────────────────────────────────────────────┐    │
│  │                    INGRESS CONTROLLER                           │    │
│  │  ┌──────────────────────────────────────────────────────┐     │    │
│  │  │  nginx-ingress                                        │     │    │
│  │  │  - TLS Termination (Let's Encrypt)                   │     │    │
│  │  │  - Rate Limiting                                      │     │    │
│  │  │  - Load Balancing                                     │     │    │
│  │  │  Host: quiz-stats.example.com                        │     │    │
│  │  └──────────────────────────────────────────────────────┘     │    │
│  └────────────────────────┬───────────────────────────────────────┘    │
│                            │                                            │
│  ┌────────────────────────▼───────────────────────────────────────┐    │
│  │              SERVICE: backend-service (ClusterIP)              │    │
│  │              Port: 80 → TargetPort: 3000                       │    │
│  └────────────────────────┬───────────────────────────────────────┘    │
│                            │                                            │
│  ┌────────────────────────▼───────────────────────────────────────┐    │
│  │           DEPLOYMENT: backend (Rolling Update)                 │    │
│  │                                                                 │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐           │    │
│  │  │   Pod 1     │  │   Pod 2     │  │   Pod 3     │  ...      │    │
│  │  │             │  │             │  │             │           │    │
│  │  │ backend:3000│  │ backend:3000│  │ backend:3000│           │    │
│  │  │ CPU: 250m   │  │ CPU: 250m   │  │ CPU: 250m   │           │    │
│  │  │ MEM: 256Mi  │  │ MEM: 256Mi  │  │ MEM: 256Mi  │           │    │
│  │  │             │  │             │  │             │           │    │
│  │  │ Liveness ✓  │  │ Liveness ✓  │  │ Liveness ✓  │           │    │
│  │  │ Readiness ✓ │  │ Readiness ✓ │  │ Readiness ✓ │           │    │
│  │  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘           │    │
│  │         │                │                │                   │    │
│  └─────────┼────────────────┼────────────────┼───────────────────┘    │
│            │                │                │                        │
│  ┌─────────▼────────────────▼────────────────▼───────────────────┐    │
│  │        HORIZONTAL POD AUTOSCALER (HPA)                        │    │
│  │  - Min Replicas: 3                                            │    │
│  │  - Max Replicas: 10                                           │    │
│  │  - Target CPU: 70%                                            │    │
│  │  - Target Memory: 80%                                         │    │
│  └───────────────────────────────────────────────────────────────┘    │
│                                                                        │
│  ┌───────────────────────────────────────────────────────────────┐    │
│  │              SERVICE: redis-service (ClusterIP)               │    │
│  │              Port: 6379 → TargetPort: 6379                    │    │
│  └────────────────────────┬──────────────────────────────────────┘    │
│                            │                                           │
│  ┌────────────────────────▼──────────────────────────────────────┐    │
│  │           STATEFULSET: redis (1 replica)                      │    │
│  │                                                                │    │
│  │  ┌─────────────────────────────────────────────────┐          │    │
│  │  │   Pod: redis-0                                  │          │    │
│  │  │                                                 │          │    │
│  │  │   redis:6379                                    │          │    │
│  │  │   CPU: 250m, MEM: 256Mi                         │          │    │
│  │  │                                                 │          │    │
│  │  │   PersistentVolumeClaim:                        │          │    │
│  │  │   └─ redis-data-redis-0 (10Gi)                 │          │    │
│  │  │                                                 │          │    │
│  │  │   Liveness: redis-cli ping ✓                   │          │    │
│  │  └─────────────────────────────────────────────────┘          │    │
│  └───────────────────────────────────────────────────────────────┘    │
│                                                                        │
│  ┌───────────────────────────────────────────────────────────────┐    │
│  │                     CONFIGMAP: backend-config                 │    │
│  │  - NODE_ENV=production                                        │    │
│  │  - LOG_LEVEL=info                                             │    │
│  │  - REDIS_URL=redis://redis-service:6379                       │    │
│  └───────────────────────────────────────────────────────────────┘    │
│                                                                        │
│  ┌───────────────────────────────────────────────────────────────┐    │
│  │                     SECRET: backend-secrets                   │    │
│  │  - OPENAI_API_KEY (encrypted)                                 │    │
│  │  - REDIS_PASSWORD (encrypted)                                 │    │
│  │  - JWT_SECRET (encrypted)                                     │    │
│  └───────────────────────────────────────────────────────────────┘    │
│                                                                        │
│  ┌───────────────────────────────────────────────────────────────┐    │
│  │                   NETWORK POLICIES                            │    │
│  │  - Backend: Allow from Ingress, Allow to Redis               │    │
│  │  - Redis: Allow only from Backend                            │    │
│  └───────────────────────────────────────────────────────────────┘    │
│                                                                        │
│  ┌───────────────────────────────────────────────────────────────┐    │
│  │               POD DISRUPTION BUDGET                           │    │
│  │  - Backend: minAvailable=2                                    │    │
│  │  - Redis: maxUnavailable=0                                    │    │
│  └───────────────────────────────────────────────────────────────┘    │
│                                                                        │
└─────────────────────────────────────────────────────────────────────────┘

Namespace: quiz-stats
Labels: app=backend, app=redis
```

---

## 4. CI/CD Pipeline Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                          DEVELOPER                                   │
│  ┌─────────────┐                                                    │
│  │  Git Commit │                                                    │
│  │  Git Push   │                                                    │
│  └──────┬──────┘                                                    │
└─────────┼────────────────────────────────────────────────────────────┘
          │
          ▼
┌─────────────────────────────────────────────────────────────────────┐
│                         GITHUB REPOSITORY                            │
│  - Source Code                                                       │
│  - Dockerfile                                                        │
│  - CI/CD Workflows                                                   │
└──────────┬───────────────────────────────────────────────────────────┘
           │
           ▼ (Trigger)
┌─────────────────────────────────────────────────────────────────────┐
│                      GITHUB ACTIONS - CI PIPELINE                    │
│                                                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  STAGE 1: Code Quality                                     │    │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────────┐            │    │
│  │  │  Lint    │  │ Format   │  │ Type Check   │            │    │
│  │  │ ESLint   │  │ Prettier │  │              │            │    │
│  │  └──────────┘  └──────────┘  └──────────────┘            │    │
│  └────────────────────┬───────────────────────────────────────┘    │
│                       │                                            │
│  ┌────────────────────▼───────────────────────────────────────┐    │
│  │  STAGE 2: Security Scanning                                │    │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────────┐            │    │
│  │  │  Trivy   │  │  Snyk    │  │ TruffleHog   │            │    │
│  │  │ npm audit│  │  OWASP   │  │ Gitleaks     │            │    │
│  │  └──────────┘  └──────────┘  └──────────────┘            │    │
│  └────────────────────┬───────────────────────────────────────┘    │
│                       │                                            │
│  ┌────────────────────▼───────────────────────────────────────┐    │
│  │  STAGE 3: Testing                                          │    │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────────┐            │    │
│  │  │  Unit    │  │ Integr.  │  │  Coverage    │            │    │
│  │  │  Jest    │  │  Tests   │  │  Codecov     │            │    │
│  │  └──────────┘  └──────────┘  └──────────────┘            │    │
│  └────────────────────┬───────────────────────────────────────┘    │
│                       │                                            │
│  ┌────────────────────▼───────────────────────────────────────┐    │
│  │  STAGE 4: Build                                            │    │
│  │  ┌──────────┐  ┌──────────┐                               │    │
│  │  │  Docker  │  │  Multi-  │                               │    │
│  │  │  Build   │  │  Platform│                               │    │
│  │  └──────────┘  └──────────┘                               │    │
│  └────────────────────┬───────────────────────────────────────┘    │
│                       │                                            │
│                       ▼ (Pass)                                     │
└───────────────────────┼────────────────────────────────────────────┘
                        │
                        ▼ (If main branch or tag)
┌───────────────────────────────────────────────────────────────────────┐
│                   GITHUB ACTIONS - CD PIPELINE                         │
│                                                                        │
│  ┌────────────────────────────────────────────────────────────┐      │
│  │  STAGE 1: Build & Push                                     │      │
│  │  ┌──────────────────────────────────────────────┐          │      │
│  │  │  Build Docker Images                         │          │      │
│  │  │  Push to GHCR                                │          │      │
│  │  │  Tag: latest, v1.x.x, commit-sha            │          │      │
│  │  └──────────────────────────────────────────────┘          │      │
│  └────────────────────┬───────────────────────────────────────┘      │
│                       │                                               │
│  ┌────────────────────▼───────────────────────────────────────┐      │
│  │  STAGE 2: Deploy to Staging                                │      │
│  │  ┌──────────────────────────────────────────────┐          │      │
│  │  │  SSH to Staging Server                       │          │      │
│  │  │  Pull Images                                 │          │      │
│  │  │  docker-compose up -d                        │          │      │
│  │  └──────────────────────────────────────────────┘          │      │
│  └────────────────────┬───────────────────────────────────────┘      │
│                       │                                               │
│  ┌────────────────────▼───────────────────────────────────────┐      │
│  │  STAGE 3: Health Checks                                    │      │
│  │  ┌──────────────────────────────────────────────┐          │      │
│  │  │  curl /health                                │          │      │
│  │  │  Run Smoke Tests                             │          │      │
│  │  └──────────────────────────────────────────────┘          │      │
│  └────────────────────┬───────────────────────────────────────┘      │
│                       │                                               │
│                       ▼ (Pass + Manual Approval)                     │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  STAGE 4: Deploy to Production                              │    │
│  │  ┌──────────────────────────────────────────────┐           │    │
│  │  │  Backup Current State                        │           │    │
│  │  │  SSH to Production Server                    │           │    │
│  │  │  Rolling Update (Zero Downtime)              │           │    │
│  │  │  Health Checks                               │           │    │
│  │  │  Rollback on Failure                         │           │    │
│  │  └──────────────────────────────────────────────┘           │    │
│  └─────────────────────┬───────────────────────────────────────┘    │
│                        │                                             │
│  ┌─────────────────────▼───────────────────────────────────────┐    │
│  │  STAGE 5: Post-Deployment                                   │    │
│  │  ┌──────────────────────────────────────────────┐           │    │
│  │  │  Send Slack Notification                     │           │    │
│  │  │  Create GitHub Release                       │           │    │
│  │  │  Update Documentation                        │           │    │
│  │  └──────────────────────────────────────────────┘           │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
└──────────────────────────────────────────────────────────────────────┘
```

---

## 5. Data Flow Sequence

```
┌──────────┐     ┌─────────┐     ┌─────────┐     ┌──────────┐     ┌──────────┐
│  User    │     │ Scraper │     │ Backend │     │ OpenAI   │     │ Stats    │
│  Browser │     │ Service │     │   API   │     │   API    │     │   App    │
└────┬─────┘     └────┬────┘     └────┬────┘     └────┬─────┘     └────┬─────┘
     │                │                │                │                │
     │ Keyboard       │                │                │                │
     │ Shortcut       │                │                │                │
     ├───────────────▶│                │                │                │
     │                │                │                │                │
     │                │ Extract DOM    │                │                │
     │                │ Questions      │                │                │
     │                │                │                │                │
     │                │ POST /api/     │                │                │
     │                │ analyze        │                │                │
     │                ├───────────────▶│                │                │
     │                │                │                │                │
     │                │                │ Validate       │                │
     │                │                │ Questions      │                │
     │                │                │                │                │
     │                │                │ Call GPT-3.5   │                │
     │                │                ├───────────────▶│                │
     │                │                │                │                │
     │                │                │                │ Process        │
     │                │                │                │ Questions      │
     │                │                │                │                │
     │                │                │ Answer Indices │                │
     │                │                │◀───────────────┤                │
     │                │                │                │                │
     │                │                │ Cache Result   │                │
     │                │                │ (Redis)        │                │
     │                │                │                │                │
     │                │                │ Send Answers   │                │
     │                │                ├────────────────────────────────▶│
     │                │                │                │                │
     │                │                │                │                │ Animate
     │                │                │                │                │ Numbers
     │                │ Success        │                │                │ Display
     │                │ Response       │                │                │
     │                │◀───────────────┤                │                │
     │                │                │                │                │
     │ Display        │                │                │                │
     │ Confirmation   │                │                │                │
     │◀───────────────┤                │                │                │
     │                │                │                │                │
     │                │                │  [Metrics]     │                │
     │                │                ├───────────────▶│                │
     │                │                │  Prometheus    │                │
     │                │                │                │                │
     │                │                │   [Logs]       │                │
     │                │                ├───────────────▶│                │
     │                │                │    Loki        │                │
     │                │                │                │                │

Timing:
- Scrape: 1-2s
- Backend Processing: <100ms
- OpenAI API: 2-5s
- Total: 3-7s
```

---

## 6. Monitoring & Alerting Flow

```
┌─────────────────────────────────────────────────────────────────────┐
│                        APPLICATION LAYER                             │
│                                                                      │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐          │
│  │ Backend  │  │ Backend  │  │ Backend  │  │  Redis   │          │
│  │  Pod 1   │  │  Pod 2   │  │  Pod 3   │  │          │          │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘          │
│       │             │             │             │                 │
│       │ /metrics    │ /metrics    │ /metrics    │ /metrics       │
│       └─────────────┴─────────────┴─────────────┘                 │
└───────────────────────────┬──────────────────────────────────────────┘
                            │
                ┌───────────┴───────────┐
                │                       │
┌───────────────▼──────┐   ┌────────────▼───────────┐
│   PROMETHEUS         │   │   LOKI                 │
│   (Metrics Storage)  │   │   (Log Aggregation)    │
│                      │   │                        │
│   - Scrape metrics   │   │   - Collect logs       │
│   - Evaluate rules   │   │   - Index & search     │
│   - Trigger alerts   │   │   - Retention          │
└───────────┬──────────┘   └────────────┬───────────┘
            │                           │
            │ Query                     │ Query
            │                           │
┌───────────▼───────────────────────────▼───────────┐
│                 GRAFANA                            │
│                                                    │
│  ┌────────────────────────────────────────────┐   │
│  │         DASHBOARDS                         │   │
│  │                                            │   │
│  │  ┌──────────────┐  ┌──────────────┐       │   │
│  │  │   Backend    │  │   Redis      │       │   │
│  │  │   Perf       │  │   Metrics    │       │   │
│  │  └──────────────┘  └──────────────┘       │   │
│  │                                            │   │
│  │  ┌──────────────┐  ┌──────────────┐       │   │
│  │  │   Resource   │  │   Business   │       │   │
│  │  │   Usage      │  │   Metrics    │       │   │
│  │  └──────────────┘  └──────────────┘       │   │
│  └────────────────────────────────────────────┘   │
│                                                    │
│  ┌────────────────────────────────────────────┐   │
│  │         ALERT RULES                        │   │
│  │                                            │   │
│  │  - Service Down                            │   │
│  │  - High Error Rate                         │   │
│  │  - High Latency                            │   │
│  │  - Resource Exhaustion                     │   │
│  │  - OpenAI API Failures                     │   │
│  └────────────────┬───────────────────────────┘   │
└───────────────────┼────────────────────────────────┘
                    │
        ┌───────────┴───────────┐
        │                       │
┌───────▼────────┐   ┌──────────▼──────────┐
│  ALERTMANAGER  │   │  NOTIFICATION       │
│                │   │  CHANNELS           │
│  - Dedup       │   │                     │
│  - Group       │   │  ┌───────────┐      │
│  - Route       │──▶│  │  Slack    │      │
│  - Silence     │   │  └───────────┘      │
│                │   │                     │
│                │   │  ┌───────────┐      │
│                │   │  │  Email    │      │
│                │   │  └───────────┘      │
│                │   │                     │
│                │   │  ┌───────────┐      │
│                │   │  │ PagerDuty │      │
│                │   │  └───────────┘      │
└────────────────┘   └─────────────────────┘
```

---

## 7. Security Layers

```
┌─────────────────────────────────────────────────────────────────────┐
│                      SECURITY ARCHITECTURE                           │
│                                                                      │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  LAYER 1: Network Security                                 │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │    │
│  │  │  Firewall    │  │  DDoS Prot.  │  │  IP Filter   │     │    │
│  │  │  (UFW/IPT)   │  │  Rate Limit  │  │  Whitelist   │     │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘     │    │
│  └────────────────────────────────────────────────────────────┘    │
│                            ↓                                        │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  LAYER 2: Transport Security                              │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │    │
│  │  │  TLS 1.3     │  │  HTTPS       │  │  WSS         │     │    │
│  │  │  Strong Ciph.│  │  HSTS        │  │  Encrypt     │     │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘     │    │
│  └────────────────────────────────────────────────────────────┘    │
│                            ↓                                        │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  LAYER 3: Application Security                            │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │    │
│  │  │  Auth/AuthZ  │  │  Input Val.  │  │  CSRF Prot.  │     │    │
│  │  │  JWT/API Key │  │  Sanitize    │  │  CORS        │     │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘     │    │
│  └────────────────────────────────────────────────────────────┘    │
│                            ↓                                        │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  LAYER 4: Container Security                              │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │    │
│  │  │  Non-Root    │  │  Read-Only   │  │  Scan Images │     │    │
│  │  │  User        │  │  FS          │  │  Trivy/Snyk  │     │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘     │    │
│  └────────────────────────────────────────────────────────────┘    │
│                            ↓                                        │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  LAYER 5: Data Security                                   │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │    │
│  │  │  Encrypt at  │  │  Secret Mgmt │  │  Audit Log   │     │    │
│  │  │  Rest        │  │  Vault       │  │  Retention   │     │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘     │    │
│  └────────────────────────────────────────────────────────────┘    │
│                            ↓                                        │
│  ┌────────────────────────────────────────────────────────────┐    │
│  │  LAYER 6: Monitoring & Response                           │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │    │
│  │  │  SIEM        │  │  Anomaly Det.│  │  Incident    │     │    │
│  │  │  Logging     │  │  Alerts      │  │  Response    │     │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘     │    │
│  └────────────────────────────────────────────────────────────┘    │
│                                                                     │
└──────────────────────────────────────────────────────────────────────┘
```

---

## 8. Scaling Strategy

```
                        LOAD PROGRESSION

┌─────────────────────────────────────────────────────────────────────┐
│  Low Load (< 10 req/s)                                              │
│  ┌──────────┐                                                       │
│  │ Nginx    │                                                       │
│  └────┬─────┘                                                       │
│       │                                                             │
│  ┌────▼─────┐                                                       │
│  │ Backend  │                                                       │
│  │   x1     │                                                       │
│  └────┬─────┘                                                       │
│       │                                                             │
│  ┌────▼─────┐                                                       │
│  │  Redis   │                                                       │
│  └──────────┘                                                       │
└─────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────┐
│  Medium Load (10-50 req/s)                                          │
│  ┌──────────┐                                                       │
│  │ Nginx    │                                                       │
│  └────┬─────┘                                                       │
│       │                                                             │
│  ┌────▼────────────────────┐                                        │
│  │ Backend x3 (HPA)        │                                        │
│  │ ┌────┐ ┌────┐ ┌────┐   │                                        │
│  │ │ B1 │ │ B2 │ │ B3 │   │                                        │
│  │ └────┘ └────┘ └────┘   │                                        │
│  └────┬────────────────────┘                                        │
│       │                                                             │
│  ┌────▼─────┐                                                       │
│  │ Redis    │                                                       │
│  │ Cache    │                                                       │
│  └──────────┘                                                       │
└─────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────┐
│  High Load (50-200 req/s)                                           │
│  ┌──────────┐    ┌──────────┐                                      │
│  │ Nginx 1  │    │ Nginx 2  │                                      │
│  └────┬─────┘    └────┬─────┘                                      │
│       │               │                                             │
│       └───────┬───────┘                                             │
│               │                                                     │
│  ┌────────────▼──────────────────────────────┐                     │
│  │ Backend x10 (Auto-scaled)                 │                     │
│  │ ┌──┐ ┌──┐ ┌──┐ ┌──┐ ┌──┐                 │                     │
│  │ │B1│ │B2│ │B3│ │B4│ │B5│ ...              │                     │
│  │ └──┘ └──┘ └──┘ └──┘ └──┘                 │                     │
│  └────────────┬──────────────────────────────┘                     │
│               │                                                     │
│  ┌────────────▼──────────────────────────────┐                     │
│  │ Redis Cluster                             │                     │
│  │ ┌──────┐ ┌──────┐ ┌──────┐               │                     │
│  │ │Master│ │Replica│ │Replica│              │                     │
│  │ └──────┘ └──────┘ └──────┘               │                     │
│  └───────────────────────────────────────────┘                     │
└─────────────────────────────────────────────────────────────────────┘

Auto-scaling Triggers:
- CPU > 70% → Scale up
- Memory > 80% → Scale up
- CPU < 30% for 5 min → Scale down
- Min replicas: 3
- Max replicas: 10
```

---

**Document Version**: 1.0.0
**Last Updated**: 2025-11-04
**Maintained By**: DevOps Team
